---
title: "Задачи по Эконометрике: F-тест"
author: "Н.В. Артамонов (МГИМО МИД России)"
output:
  html_document:
    toc: true
    toc_float: 
        collapsed: false
    number_sections: true
    df_print: paged
---

Для каждой задачи оцените соотвествующие регрессии и проведите F-тест в Python

```{r, message=FALSE, echo=FALSE}
library(stargazer)
library(lmtest)
library(car)
library(ggplot2)
library(sandwich)
data(sleep75,wage1, wage2, Labour, Electricity, package = c('wooldridge', 'Ecdat') )
# data(wage1, package = 'wooldridge')
# data(wage2, package = 'wooldridge')
# data(Labour, package = 'Ecdat')
# data(Electricity, package='Ecdat')
sleep75$gender <- factor(sleep75$male, labels = c('female', 'male') )
wage1$gender <- factor(wage1$female, labels = c('male', 'female') )
vcov.type <- 'HC3'
```

# F-тест: значимость регрессии

## sleep equation #1

Для набора данных `sleep75` рассмотрим несколько регрессий

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
my.digits.output <- 3
my.digits <- 2
sign.level <- 0.05
mod <- list()
mod[[1]] <- lm(formula=sleep~totwrk+age+I(age^2)+south+male+smsa+yngkid+marr+union, data=sleep75)
mod[[2]] <- update(mod[[1]], formula. = ~.-marr-union)
mod[[3]] <- update(mod[[1]], formula. = ~.-smsa-yngkid-marr-union)
mod[[4]] <- update(mod[[1]], formula. = ~.-totwrk-age-I(age^2)-south-male)
stargazer(mod, type='text', df=FALSE, 
          digit.separator='', digits=my.digits.output, keep.stat = c('n', 'rsq', 'adj.rsq'), 
          dep.var.caption = 'Зависимая переменная')
```

Тестируется значимость каждой регрессии. <span style="color: blue">Уровень значимости `r 100*sign.level`%</span>.
Приведите результаты неробастного и робастного F-теста.
Вычислите соотвествующию тестовые статистики и критические значения. 
**Ответ округлите до `r my.digits`-х десятичных знаков.**

Критические значения

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.cr <- NULL
for(i in 1:length(mod)) {
  my.F.cr <- qf(p=1-sign.level, df1=mod[[i]]$rank-1, df2=df.residual(mod[[i]]))
  F.cr <- c(F.cr, round(my.F.cr, digits = my.digits))
}
rm(my.F.cr)
df.F.cr <- data.frame(Регрессия=1:length(mod), F.cr=F.cr)
stargazer(df.F.cr, summary = FALSE, type='text', rownames=FALSE, digits = my.digits)
```

### Неробастный F-тест

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]])[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

### Робастный F-тест (HC3-оценка ковариационной матрицы)

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]], vcov=vcovHC(mod[[i]], type=vcov.type))[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

## cost equation #1

Для набора данных `Electricity` рассмотрим несколько регрессий

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
my.digits.output <- 3
my.digits <- 2
sign.level <- 0.01
mod <- list()
mod[[1]] <- lm(formula=log(cost)~log(q)+log(pl)+log(pk)+log(pf), data=Electricity)
mod[[2]] <- update(mod[[1]], formula. = ~.-log(pl)-log(pk)-log(pf))
mod[[3]] <- update(mod[[1]], formula. = ~.-log(pl))
mod[[4]] <- update(mod[[1]], formula. = ~.-log(q))
mod[[5]] <- update(mod[[1]], formula. = ~.-log(q)-log(pk)-log(pf))
stargazer(mod, type='text', df=FALSE, 
          digit.separator='', digits=my.digits.output, keep.stat = c('n', 'rsq', 'adj.rsq'), 
          dep.var.caption = 'Зависимая переменная')
```

Тестируется значимость каждой регрессии. <span style="color: blue">Уровень значимости `r 100*sign.level`%</span>.
Приведите результаты неробастного и робастного F-теста.
Вычислите соотвествующию тестовые статистики и критические значения. 
**Ответ округлите до `r my.digits`-х десятичных знаков.**

Критические значения

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.cr <- NULL
for(i in 1:length(mod)) {
  my.F.cr <- qf(p=1-sign.level, df1=mod[[i]]$rank-1, df2=df.residual(mod[[i]]))
  F.cr <- c(F.cr, round(my.F.cr, digits = my.digits))
}
rm(my.F.cr)
df.F.cr <- data.frame(Регрессия=1:length(mod), F.cr=F.cr)
stargazer(df.F.cr, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

### Неробастный F-тест

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]])[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

### Робастный F-тест (HC3-оценка ковариационной матрицы)

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]], vcov=vcovHC(mod[[i]], type=vcov.type))[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

## sleep equation #2

Для набора данных `sleep75` рассмотрим несколько регрессий

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
my.digits.output <- 3
sign.level <- 0.01
mod <- list()
mod[[1]] <- lm(formula=sleep~totwrk+age+I(age^2)+smsa+yngkid+marr+union, data=sleep75)
mod[[2]] <- update(mod[[1]], formula. = ~.-totwrk)
mod[[3]] <- update(mod[[1]], formula. = ~.-totwrk-smsa-yngkid-marr-union)
mod[[4]] <- update(mod[[1]], formula. = ~.-totwrk-age-I(age^2))
stargazer(mod, type='text', df=FALSE, 
          digit.separator='', digits=my.digits.output, # keep.stat = c('n', 'rsq', 'adj.rsq'), 
          dep.var.caption = 'Зависимая переменная')
```

Тестируется значимость каждой регрессии. <span style="color: blue">Уровень значимости `r 100*sign.level`%</span>.
Приведите результаты неробастного и робастного F-теста.
Вычислите соотвествующию тестовые статистики и критические значения. 
**Ответ округлите до `r my.digits`-х десятичных знаков.**

Критические значения

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.cr <- NULL
for(i in 1:length(mod)) {
  my.F.cr <- qf(p=1-sign.level, df1=mod[[i]]$rank-1, df2=df.residual(mod[[i]]))
  F.cr <- c(F.cr, round(my.F.cr, digits = my.digits))
}
rm(my.F.cr)
df.F.cr <- data.frame(Регрессия=1:length(mod), F.cr=F.cr)
stargazer(df.F.cr, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

### Неробастный F-тест

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]])[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

### Робастный F-тест (HC3-оценка ковариационной матрицы)

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]], vcov=vcovHC(mod[[i]], type=vcov.type))[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

## cost equation #2

Для набора данных `Electricity` рассмотрим несколько регрессий

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
my.digits.output <- 3
sign.level <- 0.01
mod <- list()
mod[[1]] <- lm(formula=log(cost)~log(q)+I(log(q)^2)+log(pl)+log(pk)+log(pf), data=Electricity)
mod[[2]] <- update(mod[[1]], formula. = ~.-log(pl)-log(pk)-log(pf))
mod[[3]] <- update(mod[[1]], formula. = ~.-I(log(q)^2))
mod[[4]] <- update(mod[[1]], formula. = ~.-log(q)-I(log(q)^2) )
mod[[5]] <- update(mod[[1]], formula. = ~.-log(q)-I(log(q)^2)-log(pk)-log(pf))
stargazer(mod, type='text', df=FALSE, 
          digit.separator='', digits=my.digits.output, # keep.stat = c('n', 'rsq', 'adj.rsq'), 
          dep.var.caption = 'Зависимая переменная')
```

Тестируется значимость каждой регрессии. <span style="color: blue">Уровень значимости `r 100*sign.level`%</span>.
Приведите результаты неробастного и робастного F-теста.
Вычислите соотвествующию тестовые статистики и критические значения. 
**Ответ округлите до `r my.digits`-х десятичных знаков.**

Критические значения

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.cr <- NULL
for(i in 1:length(mod)) {
  my.F.cr <- qf(p=1-sign.level, df1=mod[[i]]$rank-1, df2=df.residual(mod[[i]]))
  F.cr <- c(F.cr, round(my.F.cr, digits = my.digits))
}
rm(my.F.cr)
df.F.cr <- data.frame(Регрессия=1:length(mod), F.cr=F.cr)
stargazer(df.F.cr, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

### Неробастный F-тест

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]])[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

### Робастный F-тест (HC3-оценка ковариационной матрицы)

Тестовые статистики

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
F.stat <- NULL
for(i in 1:length(mod)) {
  my.F <- waldtest(mod[[i]], vcov=vcovHC(mod[[i]], type=vcov.type))[2,3]
  F.stat <- c(F.stat, round(my.F, digits = my.digits))
}
rm(r.sq, my.F)
df.F <- data.frame(Регрессия=1:length(mod), F.stat=F.stat)
stargazer(df.F, summary = FALSE, type='text', rownames=FALSE, digits = my.digits, digit.separator='')
```

Какая из регрессий значима?

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
significance <- NULL
for(i in 1:length(mod)) {
  if( F.stat[i]>F.cr[i]) significance <- c(significance, 'Значима')
  else significance <- c(significance, 'Незначима')
}
df.sign <- data.frame(Регрессия=1:length(mod), Значимость=significance)
stargazer(df.sign, summary = FALSE, type='text', rownames=FALSE, digit.separator='')
```

# F-тест: совместная значимость

## sleep equation #1

Для датасета `sleep75` рассмотрим регрессию **sleep на totwrk, age, male, south, smsa, yngkid, marr, union**

Результаты подгонки (коэффициенты)

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.05
mod <- lm(formula=sleep~totwrk+age+male+south+smsa+yngkid+marr+union, data=sleep75)
t.test <- coeftest(mod)
t.test
```

<span style="color: blue">Уровень значимости `r 100*sign.level`%</span>. Какие коэффициенты значимы? Ответ

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
regressors <- row.names(t.test)
sign.regressors <- NULL
for(i in 2:nrow(t.test) ) {
  if(t.test[i,4]<sign.level) sign.regressors <- c(sign.regressors, regressors[i])
}
print(sign.regressors)
```

Потестируем совместную значимость `smsa, yngkid, marr, union`, т.е. гипотезу
\(H_0:\beta_{smsa}=\beta_{yngkid}=\beta_{marr}=\beta_{union}=0\)

Вычислите критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
null.hypothesis <- c('smsa=0', 'yngkid=0', 'marr=0', 'union=0')
J <- 4
F.cr <- qf(p=1-sign.level, df1 = J, df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

### Неробастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis)
F.stat <- F.test[2,5]
p.val <- F.test[2,6]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```

### Робастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis, vcov. = vcovHC(mod, type = vcov.type))
F.stat <- F.test[2,3]
p.val <- F.test[2,4]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```

## sleep equation #2

Для датасета `sleep75` рассмотрим регрессию **sleep на totwrk, age, age^2, male, south**

Результаты подгонки (коэффициенты)

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
mod <- lm(formula=sleep~totwrk+age+I(age^2)+male+south, data=sleep75)
t.test <- coeftest(mod)
t.test
```

<span style="color: blue">Уровень значимости `r 100*sign.level`%</span>. Какие коэффициенты значимы? Ответ

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
regressors <- row.names(t.test)
sign.regressors <- NULL
for(i in 2:nrow(t.test) ) {
  if(t.test[i,4]<sign.level) sign.regressors <- c(sign.regressors, regressors[i])
}
print(sign.regressors)
```

Потестируем значимость влияния возраста, т.е. гипотезу $H_0:\beta_{age}=\beta_{age^2}=0$

Вычислите критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
null.hypothesis <- c('age=0', 'I(age^2)=0')
J <- 2
F.cr <- qf(p=1-sign.level, df1 = J, df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

### Неробастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis)
F.stat <- F.test[2,5]
p.val <- F.test[2,6]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```

### Робастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis, vcov. = vcovHC(mod, type = vcov.type))
F.stat <- F.test[2,3]
p.val <- F.test[2,4]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```

## sleep equation #3

Для датасета `sleep75` рассмотрим регрессию 
**sleep на totwrk, age, age^2, male, south, male\(\star\)totwrk**

Результаты подгонки (коэффициенты)

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
mod <- lm(formula=sleep~totwrk+age+I(age^2)+male+south+male:totwrk, data=sleep75)
t.test <- coeftest(mod)
t.test
```

<span style="color: blue">Уровень значимости `r 100*sign.level`%</span>. Какие коэффициенты значимы? Ответ

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
regressors <- row.names(t.test)
sign.regressors <- NULL
for(i in 2:nrow(t.test) ) {
  if(t.test[i,4]<sign.level) sign.regressors <- c(sign.regressors, regressors[i])
}
print(sign.regressors)
```

Потестируем значимость влияния гендерной переменной, т.е. гипотезу $H_0:\beta_{male}=\beta_{male*totwrk}=0$

Вычислите критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
null.hypothesis <- c('male=0', 'totwrk:male=0')
J <- 2
F.cr <- qf(p=1-sign.level, df1 = J, df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

### Неробастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis)
F.stat <- F.test[2,5]
p.val <- F.test[2,6]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```

### Робастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis, vcov. = vcovHC(mod, type = vcov.type))
F.stat <- F.test[2,3]
p.val <- F.test[2,4]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```


## wage equation #1

Для датасета `wage2` рассмотрим регрессию **log(wage) на age, age^2, IQ, south, urban, married**

Результаты подгонки (коэффициенты)

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
mod <- lm(formula=log(wage)~age+I(age^2)+IQ+south+urban+married, data=wage2)
t.test <- coeftest(mod)
t.test
```

<span style="color: blue">Уровень значимости `r 100*sign.level`%</span>. Какие коэффициенты значимы? Ответ

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
regressors <- row.names(t.test)
sign.regressors <- NULL
for(i in 2:nrow(t.test) ) {
  if(t.test[i,4]<sign.level) sign.regressors <- c(sign.regressors, regressors[i])
}
print(sign.regressors)
```

Потестируем значимость влияния возраста, т.е. гипотезу $H_0:\beta_{age}=\beta_{age^2}=0$

Вычислите критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
null.hypothesis <- c('age=0', 'I(age^2)=0')
J <- 2
F.cr <- qf(p=1-sign.level, df1 = J, df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

### Неробастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis)
F.stat <- F.test[2,5]
p.val <- F.test[2,6]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```

### Робастный F-тест

Вычислите тестовую статистику. **Ответ округлите до `r my.digits`-х десятичных знаков.**

Ответ:
```{r, echo=FALSE, comment=''}
F.test <- linearHypothesis(model = mod, hypothesis.matrix = null.hypothesis, vcov. = vcovHC(mod, type = vcov.type))
F.stat <- F.test[2,3]
p.val <- F.test[2,4]
print(paste('F-stats=', round(F.stat, digits = my.digits) ))
print(paste('P-val=', round(p.val, digits = my.digits) ))
```

Значимо ли совместное влияние? Ответ

```{r, echo=FALSE, comment=''}
if(F.stat>F.cr) print('Значимо') else print('Незначимо')
```

# F-тест: структурные ограничения

## cost equation

Для набора данных `Electricity` рассмотрим линейную регрессию
**log(cost) на log(q), log^2(q), log(pl), log(pk), log(pf)**

Результаты подгонки:

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
my.digits.output <- 3
mod <- lm(formula=log(cost)~log(q)+I(log(q)^2)+log(pf)+log(pl)+log(pk),data=Electricity)
t.test <- coeftest(mod)
# t.test
stargazer(mod, type='text', df=FALSE, dep.var.caption = 'Зависимая переменная',
          digits = my.digits.output, digit.separator = '')
```

<span style="color: blue">Уровень значимости `r 100*sign.level`%</span>. Какие коэффициенты значимы? Ответ

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
regressors <- row.names(t.test)
sign.regressors <- NULL
for(i in 2:nrow(t.test) ) {
  if(t.test[i,4]<sign.level) sign.regressors <- c(sign.regressors, regressors[i])
}
print(sign.regressors)
```

### Гипотеза 1

Потестируем гипотезу $H_0: \beta_{pf}+\beta_{pl}+\beta_{pk}=1$ Какая интерпретация?

#### Неробастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(pf)+log(pl)+log(pk)=1')
testing.result <- linearHypothesis(mod, null.hypothesis)
# testing.result
stargazer(testing.result[2,5:6], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,3], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,6]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

#### Робастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(pf)+log(pl)+log(pk)=1')
testing.result <- linearHypothesis(mod, null.hypothesis, vcov.=vcovHC(mod, type=vcov.type))
# testing.result
stargazer(testing.result[2,3:4], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,2], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,4]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

### Гипотеза 2

Потестируем гипотезу \(H_0: \beta_{pl}=\beta_{pk}\) Какая интерпретация?

#### Неробастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(pl)-log(pk)=0')
testing.result <- linearHypothesis(mod, null.hypothesis)
# testing.result
stargazer(testing.result[2,5:6], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,3], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,6]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

#### Робастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(pl)-log(pk)=0')
testing.result <- linearHypothesis(mod, null.hypothesis, vcov.=vcovHC(mod, type=vcov.type))
# testing.result
stargazer(testing.result[2,3:4], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,2], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,4]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

### Гипотеза 3

Потестируем гипотезу \(H_0: \beta_{pf}=\beta_{pl}=\beta_{pk}\) Какая интерпретация?

#### Неробастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(pf)-log(pk)=0', 'log(pl)-log(pk)=0')
testing.result <- linearHypothesis(mod, null.hypothesis)
# testing.result
stargazer(testing.result[2,5:6], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,3], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,6]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

#### Робастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(pf)-log(pk)=0', 'log(pl)-log(pk)=0')
testing.result <- linearHypothesis(mod, null.hypothesis, vcov.=vcovHC(mod, type=vcov.type))
# testing.result
stargazer(testing.result[2,3:4], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,2], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,4]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

## output equation

Для набора данных `Labour` рассмотрим линейную регрессию
**log(output) на log(capital), log(labour), log(wage)**

Результаты подгонки:

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.05
my.digits.output <- 3
mod <- lm(formula=log(output)~log(capital)+log(labour)+log(wage),data=Labour)
t.test <- coeftest(mod)
# t.test
stargazer(mod, type='text', df=FALSE, dep.var.caption = 'Зависимая переменная',
          digits = my.digits.output, digit.separator = '')
```

<span style="color: blue">Уровень значимости `r 100*sign.level`%</span>. Какие коэффициенты значимы? Ответ

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=''}
regressors <- row.names(t.test)
sign.regressors <- NULL
for(i in 2:nrow(t.test) ) {
  if(t.test[i,4]<sign.level) sign.regressors <- c(sign.regressors, regressors[i])
}
print(sign.regressors)
```

### Гипотеза 1

Потестируем гипотезу $H_0: \beta_{capital}+\beta_{labour}+\beta_{wage}=1$ Какая интерпретация?

#### Неробастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(capital)+log(labour)+log(wage)=1')
testing.result <- linearHypothesis(mod, null.hypothesis)
# testing.result
stargazer(testing.result[2,5:6], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,3], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,6]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

#### Робастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(capital)+log(labour)+log(wage)=1')
testing.result <- linearHypothesis(mod, null.hypothesis, vcov.=vcovHC(mod, type=vcov.type))
# testing.result
stargazer(testing.result[2,3:4], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,2], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,4]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

### Гипотеза 2

Потестируем гипотезу \(H_0: \beta_{labour}=\beta_{wage}\) Какая интерпретация?

#### Неробастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(wage)-log(labour)=0')
testing.result <- linearHypothesis(mod, null.hypothesis)
# testing.result
stargazer(testing.result[2,5:6], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,3], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,6]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

#### Робастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(wage)-log(labour)=0')
testing.result <- linearHypothesis(mod, null.hypothesis, vcov.=vcovHC(mod, type=vcov.type))
# testing.result
stargazer(testing.result[2,3:4], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,2], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,4]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

### Гипотеза 3

Потестируем гипотезу \(H_0: \beta_{capital}=\beta_{labour}=\beta_{wage}\) Какая интерпретация?

#### Неробастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(capital)-log(labour)=0', 'log(labour)-log(wage)=0')
testing.result <- linearHypothesis(mod, null.hypothesis)
# testing.result
stargazer(testing.result[2,5:6], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,3], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,6]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

#### Робастный тест

Результаты тестирования:
```{r,comment='', echo=FALSE}
null.hypothesis <- c('log(capital)-log(labour)=0', 'log(labour)-log(wage)=0')
testing.result <- linearHypothesis(mod, null.hypothesis, vcov.=vcovHC(mod, type=vcov.type))
# testing.result
stargazer(testing.result[2,3:4], summary = FALSE, type = 'text', rownames=FALSE)
```

Вычислите необходимое критическое значение. **Ответ округлите до `r my.digits`-х десятичных знаков.**

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1 = testing.result[2,2], df2 = df.residual(mod))
round(F.cr, digits = my.digits)
```

Какие результаты тестирования? Ответ

```{r,comment='', echo=FALSE}
if(testing.result[2,4]<sign.level) print('Гипотеза отвергается') else print('Гипотеза не отвергается')
```

# F-тест: структурные изменения/сдвиги

## sleep equation #1

```{r, echo=FALSE}
df.name <- 'sleep75'
df <- get(df.name)
spec <- formula(sleep~totwrk+age+I(age^2)+south+smsa+marr)
```

Для набора данных ` `r df.name` ` рассмотрим линейную регрессию 
` `r format(spec)` ` со структурыми сдвигами относительно гендерной dummy-переменной `male`

Результаты подгонки модели со структурными сдвигами 

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
my.digits.output <- 3
mod <- lm(formula=sleep~totwrk+age+I(age^2)+south+smsa+marr+male+male:totwrk+male:age+male:I(age^2)+male:south+male:smsa+male:marr,data=df)
t.test <- coeftest(mod)
round(coef(mod), my.digits.output)
```

Тестируйте значимость структурных сдвигов. <span style="color: blue"> Уровень значимости `r 100*sign.level`%</span>.
**Ответ округлите до `r my.digits`-х десятичных знаков.**

### Неробастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod)
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```

### Робастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod, vcov=vcovHC(mod, type=vcov.type))
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```

## sleep equation #2

```{r, echo=FALSE}
df.name <- 'sleep75'
df <- get(df.name)
spec <- formula(sleep~totwrk+age+I(age^2)+male+smsa)
```

Для набора данных ` `r df.name` ` рассмотрим линейную регрессию 
` `r format(spec)` ` со структурыми сдвигами относительно географической dummy-переменной `south`

Результаты подгонки модели со структурными сдвигами 

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
my.digits.output <- 3
mod <- lm(formula=sleep~totwrk+age+I(age^2)+male+smsa+south+south:totwrk+south:age+south:I(age^2)+male:south+south:smsa,data=df)
t.test <- coeftest(mod)
round(coef(mod), my.digits.output)
```

Тестируйте значимость структурных сдвигов. <span style="color: blue"> Уровень значимости `r 100*sign.level`%</span>.
**Ответ округлите до `r my.digits`-х десятичных знаков.**

### Неробастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod)
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```

### Робастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod, vcov=vcovHC(mod, type=vcov.type))
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```

## wage equation #1

```{r, echo=FALSE}
df.name <- 'wage1'
df <- get(df.name)
spec <- formula(log(wage)~exper+I(exper^2)+married+smsa)
```

Для набора данных ` `r df.name` ` рассмотрим линейную регрессию 
` `r format(spec)` ` со структурыми сдвигами относительно гендерной dummy-переменной `female`

Результаты подгонки модели со структурными сдвигами 

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
my.digits.output <- 3
mod <- lm(formula=log(wage)~exper+I(exper^2)+married+smsa+female+female:exper+female:I(exper^2)+female:married+female:smsa,data=df)
t.test <- coeftest(mod)
round(coef(mod), my.digits.output)
```

Тестируйте значимость структурных сдвигов. <span style="color: blue"> Уровень значимости `r 100*sign.level`%</span>.
**Ответ округлите до `r my.digits`-х десятичных знаков.**

### Неробастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod)
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```

### Робастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod, vcov=vcovHC(mod, type=vcov.type))
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```

## wage equation #2

Для набора данных `wage1` рассмотрим линейную регрессию **log(wage) на exper, exper^2, female, smsa**.
Регрессия была оценена на полному набору данных, только по женатым/замужним и только по неженатым/незамужним.
Результаты приведены в таблице

```{r, echo=FALSE, comment=''}
my.digits <- 3
sign.level <- 0.05
my.digits.output <- 3
spec <- formula('log(wage)~exper+I(exper^2)+female+smsa')
mod.1 <- lm(formula=spec, data=wage1, subset = married == 1)
mod.2 <- lm(formula=spec, data=wage1, subset = married == 0)
mod <- lm(formula=spec, data=wage1)
RSS <- round( c(deviance(mod), deviance(mod.1), deviance(mod.2)), digits = my.digits.output )
my.RSS <- c( 'RSS', RSS )
stargazer(mod, mod.1, mod.2, type='text', column.labels=c('общая', 'жен', 'нежет'), digits=my.digits.output,
          add.lines=list(my.RSS), df=FALSE, digit.separator="", intercept.bottom = FALSE)
```

```{r, echo=FALSE}
df.name <- 'wage1'
df <- get(df.name)
spec <- formula(log(wage)~exper+I(exper^2)+female+smsa)
```

Для набора данных ` `r df.name` ` рассмотрим линейную регрессию 
` `r format(spec)` ` со структурыми сдвигами относительно dummy-переменной `married`

Результаты подгонки модели со структурными сдвигами 

```{r,comment='', echo=FALSE}
my.digits <- 3
sign.level <- 0.01
my.digits.output <- 3
mod <- lm(formula=log(wage)~exper+I(exper^2)+female+smsa+married+married:exper+married:I(exper^2)+female:married+married:smsa,data=df)
t.test <- coeftest(mod)
round(coef(mod), my.digits.output)
```

Тестируйте значимость структурных сдвигов. <span style="color: blue"> Уровень значимости `r 100*sign.level`%</span>.
**Ответ округлите до `r my.digits`-х десятичных знаков.**

### Неробастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod)
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```

### Робастный тест

Результаты тесты:
```{r, echo=FALSE, comment=''}
mod.restr <- lm(formula = spec, data=df)
F.test <- waldtest(mod.restr, mod, vcov=vcovHC(mod, type=vcov.type))
F.stat <- F.test[2,3]
stargazer(F.test[2,3:4], summary = FALSE, type = 'text', rownames=FALSE, digits = my.digits)
```

Критическое значение

```{r, echo=FALSE, comment=''}
F.cr <- qf(p=1-sign.level, df1=F.test[2,2], df2=df.residual(mod))
round(F.cr, digits = my.digits)
```

Значимы ли структурные изменения? Ответ:

```{r, echo=FALSE, comment=''}
if(F.stat > F.cr) print('Значимы') else print('Незначимы')
```